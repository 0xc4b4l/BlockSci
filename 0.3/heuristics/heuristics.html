
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Heuristics &#8212; BlockSci 0.2 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Clustering" href="../clustering/clustering.html" />
    <link rel="prev" title="Non-Standard Script" href="../scripts/NonStandardScript.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-blocksci.blocksci_interface.heuristics">
<span id="heuristics"></span><h1>Heuristics<a class="headerlink" href="#module-blocksci.blocksci_interface.heuristics" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_address_reuse">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_address_reuse</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_address_reuse" title="Permalink to this definition">¶</a></dt>
<dd><p>If input addresses appear as an output address, the client might have reused addresses for change.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_client_change_address_behavior">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_client_change_address_behavior</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_client_change_address_behavior" title="Permalink to this definition">¶</a></dt>
<dd><p>Most clients will generate a fresh address for the change. If an output is the first to send value to an address, it is potentially the change.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_locktime">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_locktime</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_locktime" title="Permalink to this definition">¶</a></dt>
<dd><p>Bitcoin Core sets the locktime to the current block height to prevent fee sniping. If all outpus have been spent, and there is only one output that has been spent in a transaction that matches this transaction’s locktime behavior, it is the change.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_optimal_change">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_optimal_change</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_optimal_change" title="Permalink to this definition">¶</a></dt>
<dd><p>If there exists an output that is smaller than any of the inputs it is likely the change. If a change output was larger than the smallest input, then the coin selection algorithm wouldn’t need to add the input in the first place.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_peeling_chain">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_peeling_chain</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_peeling_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>If tx is a peeling chain, returns the smaller output.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_power_of_ten_value">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_power_of_ten_value</code><span class="sig-paren">(</span><em>tx: blocksci.blocksci_interface.Tx</em>, <em>digits: int=6</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_power_of_ten_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects possible change outputs by checking for output values that are multiples of 10^digits.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_by_script_type">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_by_script_type</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Set[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_by_script_type" title="Permalink to this definition">¶</a></dt>
<dd><p>If all inputs are of one script type (e.g., P2PKH or P2SH), it is likely that the change output has the same type</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.change_script_type_txes">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">change_script_type_txes</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Blockchain</em>, <em>arg1: int</em>, <em>arg2: int</em><span class="sig-paren">)</span> &#x2192; List[blocksci.blocksci_interface.Tx]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.change_script_type_txes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of transactions in the blockchain for which is_change_over returns true</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.coinjoin_txes">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">coinjoin_txes</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Blockchain</em>, <em>arg1: int</em>, <em>arg2: int</em><span class="sig-paren">)</span> &#x2192; List[blocksci.blocksci_interface.Tx]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.coinjoin_txes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all transactions in the blockchain that might be JoinMarket coinjoin transactions</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.is_change_over">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">is_change_over</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.is_change_over" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if this transaction contained all inputs of one address type and all outputs of a different type</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.is_coinjoin">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">is_coinjoin</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.is_coinjoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses basic structural features to quickly decide whether this transaction might be a JoinMarket coinjoin transaction</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.is_definite_coinjoin">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">is_definite_coinjoin</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#blocksci.blocksci_interface.heuristics.is_definite_coinjoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloaded function.</p>
<ol class="arabic simple">
<li>is_definite_coinjoin(arg0: blocksci.blocksci_interface.Tx, arg1: int, arg2: float, arg3: int) -&gt; blocksci::heuristics::CoinJoinResult</li>
</ol>
<p>This function uses subset matching in order to determine whether this transaction is a JoinMarket coinjoin. If maxDepth != 0, it limits the total number of possible subsets the algorithm will check.</p>
<ol class="arabic simple" start="2">
<li>is_definite_coinjoin(arg0: blocksci.blocksci_interface.Tx, arg1: int, arg2: float) -&gt; blocksci::heuristics::CoinJoinResult</li>
</ol>
<p>This function uses subset matching in order to determine whether this transaction is a JoinMarket coinjoin.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.is_keyset_change">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">is_keyset_change</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.is_keyset_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if this transaction contains distinct addresses which share some of the same keys, indicating that the access control structure has changed</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.is_script_deanon">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">is_script_deanon</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.is_script_deanon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if this transaction’s change address is deanonymized by the script types involved</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.keyset_change_txes">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">keyset_change_txes</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Blockchain</em>, <em>arg1: int</em>, <em>arg2: int</em><span class="sig-paren">)</span> &#x2192; List[blocksci.blocksci_interface.Tx]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.keyset_change_txes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of transaction in the blockchain for which is_keyset_change returns true</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.possible_coinjoin_txes">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">possible_coinjoin_txes</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Blockchain</em>, <em>arg1: int</em>, <em>arg2: float</em>, <em>arg3: int</em><span class="sig-paren">)</span> &#x2192; Tuple[List[blocksci.blocksci_interface.Tx], List[blocksci.blocksci_interface.Tx]]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.possible_coinjoin_txes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all transactions in the blockchain that might be coinjoin transactions</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.script_deanon_txes">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">script_deanon_txes</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Blockchain</em>, <em>arg1: int</em>, <em>arg2: int</em><span class="sig-paren">)</span> &#x2192; List[blocksci.blocksci_interface.Tx]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.script_deanon_txes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all the transactions in the blockchain for which is_script_deanon returns true</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_address_reuse">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_address_reuse</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_address_reuse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique output from change_by_address_reuse or None</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_client_change_address_behavior">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_client_change_address_behavior</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_client_change_address_behavior" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique output from change_by_client_change_address_behavior or None</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_locktime">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_locktime</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_locktime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique output from change_by_locktime or None</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_optimal_change">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_optimal_change</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_optimal_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique output from change_by_optimal_change or None</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_peeling_chain">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_peeling_chain</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_peeling_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>If tx is a peeling chain, returns the smaller output.</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_power_of_ten_value">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_power_of_ten_value</code><span class="sig-paren">(</span><em>tx: blocksci.blocksci_interface.Tx</em>, <em>digits: int=6</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_power_of_ten_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique output from change_by_power_of_ten_value or none</p>
</dd></dl>

<dl class="function">
<dt id="blocksci.blocksci_interface.heuristics.unique_change_by_script_type">
<code class="descclassname">blocksci.blocksci_interface.heuristics.</code><code class="descname">unique_change_by_script_type</code><span class="sig-paren">(</span><em>arg0: blocksci.blocksci_interface.Tx</em><span class="sig-paren">)</span> &#x2192; Optional[blocksci.blocksci_interface.Output]<a class="headerlink" href="#blocksci.blocksci_interface.heuristics.unique_change_by_script_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique output from change_by_script_type or None</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">BlockSci</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">BlockSci</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chain/chain.html">Chain Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Script Classes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Heuristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clustering/clustering.html">Clustering</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../scripts/NonStandardScript.html" title="previous chapter">Non-Standard Script</a></li>
      <li>Next: <a href="../clustering/clustering.html" title="next chapter">Clustering</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Harry Kalodner.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/heuristics/heuristics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>